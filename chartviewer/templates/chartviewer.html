{% extends 'base.html' %}
{% block body_class %}footer_fixed{% endblock %}
{% block body %}
<div class="right_col" role="main">
  <div class="">
    <div class="page-title">
    <div class="col-md-12 col-sm-12 col-xs-12">
    <div class="x_panel">
      <div class="x_title">
        <h2><i class="fa fa-bars"></i> Vertical Tabs <small>Float left</small></h2>
        <ul class="nav navbar-right panel_toolbox">
          <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
          </li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-wrench"></i></a>
            <ul class="dropdown-menu" role="menu">
              <li><a href="#">Settings 1</a>
              </li>
              <li><a href="#">Settings 2</a>
              </li>
            </ul>
          </li>
          <li><a class="close-link"><i class="fa fa-close"></i></a>
          </li>
        </ul>
        <div class="clearfix"></div>
      </div>
      <div class="x_content">
        <div class="col-xs-1">
          <!-- required for floating -->
          <!-- Nav tabs -->
          <ul class="nav nav-tabs tabs-left">
            <li class="active"><a href="#HK" data-toggle="tab">HK</a>
            </li>
            <!--<li><a href="#profile" data-toggle="tab">US</a>-->
            <!--</li>-->
            <!--<li><a href="#messages" data-toggle="tab">JP</a>-->
            <!--</li>-->
            <!--<li><a href="#settings" data-toggle="tab">CH</a>-->
            <!--</li>-->
          </ul>
        </div>

        <div class="col-xs-11">
          <!-- Tab panes -->
          <div class="tab-content">

            <!-- HK TAB! -->
            <div class="tab-pane active" id="HK">
                {% csrf_token %}
                <!-- Search by stock number -->
                <span class="section">Search by Stock number</span>
                <div class="form-group">
                <label class="control-label col-md-3 col-sm-3 col-xs-12" for="HK_input">Stock Number (separate by ,)</span>
                </label>
                <div class="col-md-6 col-sm-6 col-xs-12">
                  <input type="text" id="HK_input" required="required" class="form-control col-md-7 col-xs-12">
                </div>
                   <button id="HK_search" type="submit" class="btn btn-success">Submit</button>
              </div>

              <!-- Search by -->
                <!--<span class="section">Search by </span>-->
                <!--<div class="col-md-3">-->
                    <!--<select id="heard" class="form-control" required="">-->
                      <!--<option value="">Choose..</option>-->
                      <!--<option value="press">Press</option>-->
                      <!--<option value="net">Internet</option>-->
                      <!--<option value="mouth">Word of mouth</option>-->
                    <!--</select>-->
                <!--</div>-->

            </div>

            <div class="tab-pane" id="profile">Profile Tab.</div>
            <div class="tab-pane" id="messages">Messages Tab.</div>
            <div class="tab-pane" id="settings">Settings Tab.</div>
          </div>
        </div>

        <div class="clearfix"></div>

      </div>
        <!-- Period -->
        <span class="section">Period</span>
        <div class="col-md-2"><input type="checkbox" name="period" value=3 /> 30 minutes</div>
        <div class="col-md-2"><input type="checkbox" name="period" value=4 /> 10 days</div>
        <div class="col-md-2"><input type="checkbox" name="period" value=7 /> 3 months</div>
        <div class="col-md-2"><input type="checkbox" name="period" value=9 /> 1 year</div>
        <div class="col-md-2"><input type="checkbox" name="period" value=16 /> 5 years</div>
        <div class="col-md-2"><input type="checkbox" name="period" value=2059 /> 15 years</div>
    </div>

    </div>
    </div>
  </div>
    <div class="col-md-12 col-sm-12 col-xs-12">
      <div id="results"></div>
    </div>
    <div class="clearfix"></div>
</div>
<div class="clearfix"></div>
<!-- footer content -->
<footer>
  <div id='footer' class="pull-right">

  </div>
  <div class="clearfix"></div>
</footer>
<!-- /footer content -->
{% endblock %}

{% block more_js %}
<script>
$('#HK_search').click(function () {
    console.log('hi');
  var input = $('#HK_input').val();
  var stocks = input.split(',');
  console.log(input);
  var period = [];
  $('[name="period"]').each(function(){
    if($(this).is(':checked')){
        period.push($(this).val());
    };
  });
  console.log(period);
  $.ajax({
      url: "/chartviewer/results/",
      type: "POST",
      data: {
          "input": input,
          "period": JSON.stringify(period),
          csrfmiddlewaretoken: $("input[name=csrfmiddlewaretoken").val(),
      },
      success: function(data){
           $('#results').html(data);
      }
  });
  html = '';
  console.log(stocks);
  for (i = 0; i < stocks.length; i++) {
     html += '<a href="#chart' + stocks[i] + '">' + stocks[i] + "</a> ";
  };
  console.log(html);
  document.getElementById("footer").innerHTML = html;
});
</script>
{% endblock %}